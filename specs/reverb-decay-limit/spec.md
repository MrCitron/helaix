# Feature Spec: Reverb Decay Limit

## Goal
Prevent the "huge noisy sound" caused by Reverb `Decay` parameters being set to their absolute maximum (1.0 internally, 10.0 in UI).

## Functional Requirements

### 1. AI System Prompt Update
- Update the `ChatPresetEngineer` system prompt to include a specific instruction for Reverb parameters.
- **Instruction**: "For Reverb blocks, never set the 'Decay' or 'VerbDecay' parameter to its maximum value (1.0). Keep it at 0.7 or lower to avoid excessive noise."

### 2. Backend Parameter Sanitization
- Modify the block parameter application logic in `pkg/gemini/preset_engineer.go`.
- Identify blocks that are Reverbs using the existing prefix check (`HD2_Reverb`, `VIC_Reverb`).
- If a block is a Reverb and contains a parameter named `Decay` or `VerbDecay`:
    - Intercept the value.
    - If the value is `>= 0.7`, cap it at `0.7`.
    - *Optional*: Apply a soft cap where any value `> 0.7` is logged or slightly reduced.

### 3. Threshold Configuration
- **Max Internal Value**: 1.0
- **Safety Cap**: 0.7 (corresponds to 7.0 on the pedalboard/HX Edit).

## Visual Requirements
- No new UI elements are required.
- The `SignalChain` visualizer will reflect the sanitized values generated by the backend.

## Edge Cases
- **Legacy Blocks**: Some older models might use different parameter names for decay (though `Decay` is standard).
- **Other Blocks with Decay**: Ensure that blocks like "Dynamic" or "Filter" that might have a "Decay" parameter are NOT affected unless they are also categorized as Reverbs.
- **User Explicit Requests**: If a user explicitly asks for high decay in the chat, the system should still respect the safety cap of 0.7 to prevent hardware/sound issues, perhaps with a slight mention in the AI's explanation.
